<header>
  <nav class="blur main-header position-fixed navbar-light shadow w-100 p-md-2"
    [ngClass]="{hide: !isHeaderShown}"
  >
    <div class="d-flex justify-content-between align-items-center">
      <div class="ml-2 flex-grow-0 flex-shrink-0">
        <a class="navbar-brand" ref="#">
          <img class="d-none d-md-block" src="assets/img/logo.png" />
          <img class="d-md-none brand-sm" src="assets/img/logo-sm.png" />
        </a>
      </div>
      <div class="mx-2 mx-md-4 flex-grow-1 flex-shrink-1">
        <div class="searchbar rounded-pill">
          <input type="text"  aria-describedby="Search for anything" placeholder="Search for anything" />
        </div>
      </div>
      <div *ngIf="!token; else logoutblock" class="d-none d-md-block flex-grow-0 glrex-shrink-0">
        <div class="d-flex align-items-center flex-nowrap">
          <a class="btn" data-toggle="modal" data-target="#loginmodal">Login</a>
          <a class="btn btn-signup text-darkblue border-darkblue" data-toggle="modal" data-target="#signupModal">Sign up</a>
        </div>
      </div>

      <ng-template #logoutblock>
        <div class="ml-auto d-none d-md-block w-160p position-relative">
          <dashboard-menu id="dashboardMenuButton"
            ui="button"
            buttonDirection="right"
            [styleButton]="{background: '#ffffff33'}"
            [user]="user"
            (click)="isDashboardMenuShown = !isDashboardMenuShown"
          ></dashboard-menu>
          <div class="position-absolute top-10p dashboard-menu-wrapper-md">

            <!-- <img *ngIf="!user.profileImage" src="assets/img/default_user.jpg" class="user-img mr-2" />
            <img *ngIf="user.profileImage"
              src="https://api.prompthealth.ca/users/{{updateData.profileImage?updateData.profileImage:user.profileImage}}"
              class="user-img mr-2" />
            -->
 
          </div>
        </div>
      </ng-template>

        <div class="d-md-none flex-grow-0">
        <button class="btn btn-icon text-blue" (click)="showMenu()">
          <i class="fas fa-bars text-darkblue"></i>
        </button>
      </div>
    </div>

    <div class="d-none d-md-block w-100">
      <div class="d-flex justify-content-center align-items-center w-100">
        <div class="nav-item">
          <a class="nav-link" class="nav-link" [routerLink]="'/'">Home</a>
        </div>
        <div class="nav-item" (click)="showMenu()">
          <a class="nav-link">Category</a>
        </div>
        <div class="nav-item">
          <a class="nav-link" class="nav-link" [routerLink]="['/subscriptionplan-partner']">Partner</a>
        </div>
        <div class="nav-item">
          <a class="nav-link" class="nav-link" [routerLink]="['/blogs']">Blogs</a>
        </div>
      </div>
    </div>


    <!-- menu for medium view or more-->
    <div class="menu d-none d-md-block" *ngIf="isNavMenuShown && catService.categoryList && catService.categoryList.length>0" [@fade]>
      <div class="close-menu-full" (click)="hideMenu()"></div>

      <div class="shadow menu_inner position-relative">
        <button class="btn close-menu btn-icon text-blue" (click)="hideMenu()">
          <i class="fas fa-times"></i>
        </button>

        <div class="menu-title center">Service/Goal</div>
        <div class="menu-category-group w-100">
          <div class="col-4 menu-category">
            <ul class="category">
              <li *ngFor="let cat of catService.categoryList; let i = index" [ngClass]="{active: (activeCategory == i)}" (click)="changeMenuCategory(i)">
                <div class="highlighter"></div>
                <span>{{cat.item_text}}</span>
              </li>
            </ul>
          </div>
          <div class="col-8 menu-subcategory">
            <img [src]="'assets/img/services_' + catService.categoryList[activeCategory].label + '.png'"/>
            <ul class="category sub"
              [class]="classSubcategory"
            >
              <li *ngFor="let sub of catService.categoryList[activeCategory].subCategory"
                [class]="classSubcategoryItem"
              >
                <a [routerLink]="['/dashboard/listing']"
                  [queryParams]=" {id: sub._id, type: 'goal'}"
                  (click)="hideMenu()"
                >{{sub.item_text}}</a>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </nav>
</header>
<div class="spacer-top" [ngClass]="{loggedin: token}"></div>

<dashboard-menu class="d-none d-md-block position-fixed dashboard-menu-wrapper-md"
  *ngIf="isDashboardMenuShown"
  [@fadeFast]
  [user]="user"
  [scrollDetector]="isDashboardMenuShown" 
  [offset]="50" 
  (detect)="isDashboardMenuShown = false;"
  (logout)="logout()"
  (clickOutside)="onClickOutsideOfDashboardMenuMd($event)"
  (close)="isDashboardMenuShown = false"
></dashboard-menu> 

<!-- Menu for Small view-->
<div class="menu-sm d-md-none" id="menu_sm" *ngIf="isNavMenuShown" [@fade]>
  <button class="btn close-menu-sm btn-icon text-blue" (click)="hideMenu()">
    <i class="fas fa-times"></i>
  </button>
  <ul class="menu-item font-weight-bold"
    [ngClass]="{before: (levelMenuSm > 0), after: (levelMenuSm < 0)}"
  >
    <li><a class="text-blue" [routerLink]="'/'" (click)="hideMenu()">Home</a></li>
    <li><a class="text-blue" (click)="scrollMenuSm(1)">Category</a></li>
    <li><a class="text-blue" [routerLink]="['/subscriptionplan-partner']" (click)="hideMenu()">Partner</a></li>
    <li><a class="text-blue" [routerLink]="['/blogs']" (click)="hideMenu()">Blogs</a></li>

    <li *ngIf="!token">
      <a class="px-2 text-blue" data-toggle="modal" data-target="#loginmodal" (click)="hideMenu()">Log in</a>
      <span class="display-inline-block mx-2">/</span>
      <a class="px-2 text-blue" data-toggle="modal" data-target="#signupModal" (click)="hideMenu()">Sign up</a>
    </li>

    <li class="dashboard-menu-wrapper" *ngIf="token">
      <dashboard-menu class="bg-white overflow-hidden"
        [user]="user"
        [styleMenu]="{ color: '#6d6e71'}"
        (logout)="logout()"
      ></dashboard-menu>
    </li>
  </ul>

  <ul class="menu-item sub"
    [ngClass]="{before: (levelMenuSm > 1), after: (levelMenuSm < 1)}"
  >
    <li class="menu-subtitle font-weight-bold">
      <button class="btn btn-icon text-blue" (click)="scrollMenuSm(0)">
        <i class="fas fa-arrow-left"></i>
      </button>
      Category
    </li>
    <li *ngFor="let cat of catService.categoryList; let i = index">
      <span (click)="changeMenuCategory(i); scrollMenuSm(2)">{{cat.item_text}}</span>
    </li>
  </ul>

  <ul class="menu-item sub"
    *ngIf="catService.categoryList && catService.categoryList.length > 0"
    [ngClass]="{before: (levelMenuSm > 2), after: (levelMenuSm < 2)}"
  >
    <li class="menu-subtitle font-weight-bold d-flex align-items-center">
      <button class="btn btn-icon text-blue" (click)="scrollMenuSm(1)">
        <i class="fas fa-arrow-left"></i>
      </button>
      <span class="d-inline-block">
        {{catService.categoryList[activeCategory].item_text}}
      </span>
    </li>
    <li *ngFor="let sub of catService.categoryList[activeCategory].subCategory">
      <a [routerLink]="['/dashboard/listing']"
        [queryParams]=" {id: sub._id, type: 'goal'}"
        (click)="hideMenu()"
      >{{sub.item_text}}</a>
    </li>
  </ul>
</div>



<!-- Modal signup -->
<div class="modal fade" id="signupModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
  aria-hidden="true">
  <div class="modal-dialog" role="document" style="margin: auto !important;width:100%">
    <div class="modal-content mk-border">
      <div class="modal-header">
        <h5 class="modal-title w-100 text-center" id="exampleModalLabel" style="text-indent: 56px;">
          Join network
        </h5>
        <button #signup type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center pb-4">
        <div class="text-center">
          <img src="assets/img/logo.png" class="mb-3" style="max-width: 220px;" />
        </div>
        <div class="text-secondary font-weight-bold mb-3">Are You A</div>
        <a class="btn btn-primary w-100 mr-2" (click)="professionalOption = !professionalOption"
          style="max-width: 175px;">PROFESSIONAL</a>
        or
        <a class="btn btn-secondary w-100 ml-2" [routerLink]="['/auth/registration', 'u']" data-dismiss="modal"
          style="max-width: 175px;" aria-label="Close">CLIENT</a>
      </div>
      <div class="mb-3 text-center" *ngIf="professionalOption">
        <div class="radio mb-3">
          <input type="radio" name="userType" (change)="handleChange('/auth/registration', 'sp')" />
          <span class="font-weight-bold">Service Provider</span>
        </div>
        <div class="radio">
          <input type="radio" name="userType" (change)="handleChange('/auth/registration', 'c')" />
          <span class="font-weight-bold">Center</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal login -->
<div class="modal fade" id="loginmodal" tabindex="-1" role="dialog" aria-labelledby="loginmodal" aria-hidden="true">
  <div class="modal-dialog" role="document" style="margin: auto !important;width:100%">
    <div class="modal-content mk-border">
      <div class="modal-header">
        <h5 class="modal-title w-100 text-center" id="exampleModalLabel" style="text-indent: 56px;">
          Login
        </h5>
        <button #signin type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center pb-4">
        <div class="text-center">
          <img src="assets/img/logo.png" class="mb-3" style="max-width: 220px;" />
        </div>
        <div class="text-secondary font-weight-bold mb-3">Are You A</div>
        <a class="btn btn-primary w-100 mr-2" (click)="professionalOption = !professionalOption"
          style="max-width: 175px;">PROFESSIONAL</a>
        or
        <a class="btn btn-secondary w-100 ml-2" [routerLink]="['/auth/login', 'u']" (click)="optUserType('U')"
          data-dismiss="modal" style="max-width: 175px;" aria-label="Close">CLIENT</a>
      </div>
      <div class="mb-3" *ngIf="professionalOption">
        <div class="radio">
          <input type="radio" name="userTypeLogin" (change)="handleChange('/auth/login', 'sp')"
            (click)="optUserType('SP')" />
          <span>Service Provider</span>
        </div>
        <div class="radio">
          <input type="radio" name="userTypeLogin" (change)="handleChange('/auth/login', 'c')"
            (click)="optUserType('C')" />
          <span>Center</span>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Modal pricing -->
<div class="modal fade" id="pricingmodal" tabindex="-1" role="dialog" aria-labelledby="loginmodal" aria-hidden="true">
  <div class="modal-dialog" role="document" style="margin: auto !important;width:100%">
    <div class="modal-content mk-border">
      <div class="modal-header">
        <h5 class="modal-title w-100 text-center" id="pricingModalLabel" style="text-indent: 56px;">
          Pricing
        </h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body text-center pb-4">
        <div class="text-center">
          <img src="assets/img/logo.png" class="mb-3" style="max-width: 220px;" />
        </div>
        <div class="text-secondary font-weight-bold mb-3">Are You A</div>
        <a class="btn btn-primary w-100 mr-2" [routerLink]="['/subscriptionplan']" data-dismiss="modal"
          aria-label="Close" style="max-width: 175px;">PROFESSIONAL</a>
        or
        <a class="btn btn-secondary w-100 ml-2" [routerLink]="['/subscriptionplan']" data-dismiss="modal"
          style="max-width: 175px;" aria-label="Close">USER</a>
      </div>
    </div>
  </div>
</div>
